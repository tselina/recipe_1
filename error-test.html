<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Test - Recipe Portion Tracker</title>
</head>
<body>
    <h1>Error Test</h1>
    <div id="test-results"></div>

    <script src="js/storage-manager.js"></script>
    <script src="js/data-models.js"></script>
    <script src="js/barcode-scanner.js"></script>
    <script src="js/barcode-generator.js"></script>
    <script src="js/product-database.js"></script>
    <script src="js/recipe-manager.js"></script>
    <script src="js/portion-calculator.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="js/app.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const testResults = document.getElementById('test-results');
            
            function addResult(message, type = 'info') {
                const div = document.createElement('div');
                div.style.cssText = `
                    margin: 10px 0; padding: 10px; border-radius: 4px;
                    ${type === 'success' ? 'background: #d4edda; color: #155724;' : 
                      type === 'error' ? 'background: #f8d7da; color: #721c24;' : 
                      'background: #d1ecf1; color: #0c5460;'}
                `;
                div.textContent = message;
                testResults.appendChild(div);
            }
            
            try {
                // Test 1: Check if all classes are available
                const requiredClasses = [
                    'StorageManager', 'Recipe', 'Product', 'ConsumptionResult', 'Ingredient',
                    'RecipeManager', 'PortionCalculator', 'ProductDatabase', 'UIController', 
                    'BarcodeScanner', 'BarcodeGenerator'
                ];
                
                const missingClasses = [];
                requiredClasses.forEach(className => {
                    if (typeof window[className] === 'undefined') {
                        missingClasses.push(className);
                    }
                });
                
                if (missingClasses.length === 0) {
                    addResult('‚úÖ All required classes are available', 'success');
                } else {
                    addResult('‚ùå Missing classes: ' + missingClasses.join(', '), 'error');
                    return;
                }
                
                // Test 2: Try to instantiate UIController
                const storage = new StorageManager();
                const recipeManager = new RecipeManager(storage);
                const calculator = new PortionCalculator();
                const productDb = new ProductDatabase(storage);
                
                const uiController = new UIController(recipeManager, calculator, productDb, storage);
                addResult('‚úÖ UIController instantiated successfully', 'success');
                
                // Test 3: Try to use barcode generator
                const barcodeGenerator = new BarcodeGenerator();
                const testBarcode = barcodeGenerator.generateBarcodeDataURL('TEST123');
                if (testBarcode.startsWith('data:image/svg+xml')) {
                    addResult('‚úÖ BarcodeGenerator working correctly', 'success');
                } else {
                    addResult('‚ùå BarcodeGenerator not working properly', 'error');
                }
                
                addResult('üéâ All tests passed! No syntax errors found.', 'success');
                
            } catch (error) {
                addResult('‚ùå Error: ' + error.message, 'error');
                console.error('Test error:', error);
            }
        });
    </script>
</body>
</html>