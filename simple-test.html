<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Integration Test</title>
</head>
<body>
    <h1>Simple Integration Test</h1>
    <div id="results"></div>

    <!-- Load modules in correct order -->
    <script src="js/storage-manager.js"></script>
    <script src="js/data-models.js"></script>
    <script src="js/barcode-scanner.js"></script>
    <script src="js/product-database.js"></script>
    <script src="js/recipe-manager.js"></script>
    <script src="js/portion-calculator.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="js/app.js"></script>

    <script>
        function log(message) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.textContent = message;
            results.appendChild(div);
            console.log(message);
        }

        // Wait for all scripts to load
        setTimeout(() => {
            try {
                log('Testing class availability...');
                
                // Clear any existing data first
                const storage = new StorageManager();
                storage.clearAll();
                
                // Check if classes are available
                log('StorageManager: ' + (typeof StorageManager !== 'undefined'));
                log('Recipe: ' + (typeof Recipe !== 'undefined' || typeof window.Recipe !== 'undefined'));
                log('Product: ' + (typeof Product !== 'undefined' || typeof window.Product !== 'undefined'));
                log('ConsumptionResult: ' + (typeof ConsumptionResult !== 'undefined' || typeof window.ConsumptionResult !== 'undefined'));
                log('RecipeManager: ' + (typeof RecipeManager !== 'undefined'));
                log('PortionCalculator: ' + (typeof PortionCalculator !== 'undefined'));
                log('ProductDatabase: ' + (typeof ProductDatabase !== 'undefined'));
                log('BarcodeScanner: ' + (typeof BarcodeScanner !== 'undefined'));
                log('UIController: ' + (typeof UIController !== 'undefined'));
                
                log('Testing class instantiation...');
                
                // Test instantiation
                const storage = new StorageManager();
                log('✓ StorageManager created');
                
                const recipeManager = new RecipeManager(storage);
                log('✓ RecipeManager created');
                
                const calculator = new PortionCalculator();
                log('✓ PortionCalculator created');
                
                const productDb = new ProductDatabase(storage);
                log('✓ ProductDatabase created');
                
                const barcodeScanner = new BarcodeScanner();
                log('✓ BarcodeScanner created');
                
                log('✓ All classes instantiated successfully!');
                
                // Test basic functionality
                log('Testing basic functionality...');
                
                const recipe = recipeManager.createRecipe('Test Recipe', [
                    { name: 'Flour', weight: 100 },
                    { name: 'Sugar', weight: 50 }
                ]);
                log('✓ Recipe created: ' + recipe.name);
                
                const result = calculator.calculatePortions(recipe, 75);
                log('✓ Portion calculated: ' + result.consumedWeight + 'g');
                
                log('✓ Integration test completed successfully!');
                
            } catch (error) {
                log('✗ Error: ' + error.message);
                console.error(error);
            }
        }, 200);
    </script>
</body>
</html>